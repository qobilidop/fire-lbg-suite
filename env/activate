# This script activates environment for the project.
# It should only be used as
# $ source bin/activate
# from the project root directory.

# Export project environment
export PROJECT_NAME="fire2-lbg"
export PROJECT_DIR="$PWD"
export LOCAL_PREFIX="$PROJECT_DIR/.local"
export LOCAL_CONDA_PREFIX="$LOCAL_PREFIX/conda-env"
export LOCAL_ENV_FILE="$LOCAL_PREFIX/env"

# Alter system environment
mkdir -p "$LOCAL_PREFIX/bin"
export PATH="$LOCAL_PREFIX/bin:$PATH"
export PATH="$PROJECT_DIR/code/bin:$PATH"

# Activate conda env
if [ -d "$LOCAL_CONDA_PREFIX/conda-meta" ]; then
    source enable-conda
    conda activate "$LOCAL_CONDA_PREFIX"
    export PATH="$LOCAL_CONDA_PREFIX/bin:$PATH"
fi

# Activate local env
if [ -f "$LOCAL_ENV_FILE" ]; then
    export LOCAL_ENV="$(cat "$LOCAL_ENV_FILE")"
    source "env/$LOCAL_ENV/activate"
fi
